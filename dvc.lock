schema: '2.0'
stages:
  reshape:
    cmd: src/clean_expression.py data/zhong2021/s4-plasma_protein_profiling.csv data/zhong2021/expression.csv
    deps:
    - path: src/clean_expression.py
      hash: md5
      md5: 90db3527549c84de0b7df782313b758c
      size: 1072
    outs:
    - path: data/zhong2021/expression.csv
      hash: md5
      md5: 87d24147c0f08f0a6a5550d3729010ae
      size: 5097803
  bin_expression:
    cmd: "src/motif_mining/graphs/bin_expression.py  data/zhong2021/expression.csv\
      \  data/mining  --value npx  --var_id symbol --idmap data/string/string_v12_idmap.csv\n"
    deps:
    - path: data/zhong2021/expression.csv
      hash: md5
      md5: 87d24147c0f08f0a6a5550d3729010ae
      size: 5097803
    - path: src/motif_mining/graphs/bin_expression.py
      hash: md5
      md5: 83193852c86a46a37bf2f728b4817586
      size: 5541
      isexec: true
    outs:
    - path: data/mining/expression/expression_binned.csv
      hash: md5
      md5: bc9b32cd7521c82b5c0ddc675508742a
      size: 8960381
  generate_graphs:
    cmd: "src/motif_mining/graphs/generate.py  data/mining/expression/expression_binned.csv\
      \  data/string/9606.protein.physical.links.detailed.v12.0.txt.gz data/mining/graphs\
      \  --node_ids data/string/string_v12_idmap.csv --var_id symbol --obs_id id_visit
      --clobber\n"
    deps:
    - path: data/mining/expression/expression_binned.csv
      hash: md5
      md5: a92959a411e78dc25336a23e7956d4e6
      size: 4247044
    - path: data/string/string_v12_idmap.csv
      hash: md5
      md5: 7099bad7abaa68194dea08852109cdf3
      size: 1361627
    - path: src/motif_mining/graphs/generate.py
      hash: md5
      md5: 977dd0c0e3175c36964e5f3165643550
      size: 7025
  clean:
    cmd: src/clean_expression.py data/zhong2021/s4-plasma_protein_profiling.csv data/zhong2021/expression.csv
      --meta_out data/zhong2021/meta.csv
    deps:
    - path: data/zhong2021/s4-plasma_protein_profiling.csv
      hash: md5
      md5: 424729302ee88b4643739db1a3554ba3
      size: 1807575
    - path: src/clean_expression.py
      hash: md5
      md5: c25b7e336bd0b067b47245b8fada6757
      size: 1631
    outs:
    - path: data/zhong2021/expression.csv
      hash: md5
      md5: 87d24147c0f08f0a6a5550d3729010ae
      size: 5097803
    - path: data/zhong2021/meta.csv
      hash: md5
      md5: 5f30c69f72345302cc9adbc77972b46a
      size: 1690
  setup_exp:
    cmd: "src/motif_mining/mining/setup_experiment.py data/zhong2021/meta.csv data/mining/graphs
      data/mining/240522-split --p_train 0.8 --subject_id subject_id --obs_id id_visit
      --group_id visit\n"
  mine:
    cmd: "src/motif_mining/mining/gaston_cov.py data/mining/240522-split/train --size
      3 --support 30\n"
  extract:
    cmd: "src/motif_mining/mining/extract_results.py data/mining/240522-split/train
      --purge_motifs --processes 8\n"
    outs:
    - path: data/mining/240522-split/train/motifs
      hash: md5
      md5: c68ce7a1e2e6c4a627607f1e6433c21f.dir
      size: 64707829
      nfiles: 2
  match:
    cmd: "src/motif_mining/mining/match_motifs.py data/mining/240522-split/train/motifs
      data/mining/240522-split/train/meta.csv data/zhong2021/meta.csv data/mining/240522-split/freq/matched_motifs.csv
      -e data/mining/expression/expression_binned.csv\n"
    outs:
    - path: data/mining/240522-split/freq/matched_motifs.csv
      hash: md5
      md5: b693b77007761f41e0cce242288a57c9
      size: 1161346694
  join_metadata:
    cmd: "src/motif_mining/mining/join_metadata.py data/zhong2021/meta.csv data/mining/240522-split/train/gaston_files
      data/mining/240522-split/train/meta.csv --meta_obs_id id_visit\n"
    outs:
    - path: data/mining/240522-split/train/meta.csv
      hash: md5
      md5: f9dd73afdf165e573006e5b99a102b49
      size: 18451
