schema: '2.0'
stages:
  reshape:
    cmd: src/clean_expression.py data/zhong2021/s4-plasma_protein_profiling.csv data/zhong2021/expression.csv
    deps:
    - path: src/clean_expression.py
      hash: md5
      md5: 90db3527549c84de0b7df782313b758c
      size: 1072
    outs:
    - path: data/zhong2021/expression.csv
      hash: md5
      md5: 87d24147c0f08f0a6a5550d3729010ae
      size: 5097803
  bin_expression:
    cmd: "src/motif_mining/graphs/bin_expression.py  data/zhong2021/expression.csv\
      \  data/mining  --value npx  --var_id symbol --idmap data/string/string_v12_idmap.csv\n"
    deps:
    - path: data/zhong2021/expression.csv
      hash: md5
      md5: 31f7c3a1ef3652f6339239ea930bc15c
      size: 5097801
    - path: src/motif_mining/graphs/bin_expression.py
      hash: md5
      md5: 673db4f1292593157d57ec712d9b6809
      size: 5871
      isexec: true
    outs:
    - path: data/mining/expression/expression_binned.csv
      hash: md5
      md5: 0bcaa60098daf7b7b234506a69805b20
      size: 8960379
  generate_graphs:
    cmd: "src/motif_mining/graphs/generate.py  data/mining/expression/expression_binned.csv\
      \  data/string/9606.protein.physical.links.detailed.v12.0.txt.gz data/mining/graphs\
      \  --clobber\n"
    deps:
    - path: data/mining/expression/expression_binned.csv
      hash: md5
      md5: 0bcaa60098daf7b7b234506a69805b20
      size: 8960379
    - path: data/string/string_v12_idmap.csv
      hash: md5
      md5: 7099bad7abaa68194dea08852109cdf3
      size: 1361627
    - path: src/motif_mining/graphs/generate.py
      hash: md5
      md5: 198eeacf6eda0b557ddff85523d7a914
      size: 7320
      isexec: true
  clean:
    cmd: "src/clean_expression.py data/zhong2021/s4-plasma_protein_profiling.csv data/zhong2021/expression.csv
      --meta_out data/zhong2021/meta.csv --rename_group_id\n"
    deps:
    - path: data/zhong2021/s4-plasma_protein_profiling.csv
      hash: md5
      md5: 424729302ee88b4643739db1a3554ba3
      size: 1807575
    - path: src/clean_expression.py
      hash: md5
      md5: 2bb9f8d9f32bb95620989e676ca36e0f
      size: 2090
    outs:
    - path: data/zhong2021/expression.csv
      hash: md5
      md5: 31f7c3a1ef3652f6339239ea930bc15c
      size: 5097801
    - path: data/zhong2021/meta.csv
      hash: md5
      md5: 4efbfbc67599b05d6c33664c61cda3a9
      size: 1688
  setup_exp:
    cmd: "src/motif_mining/mining/setup_experiment.py data/zhong2021/meta.csv data/mining/graphs
      data/mining/240522-split --p_train 0.8 --symlink --meta_out data/mining/240522-split/meta.csv
      --override_train_mask data/og_sample_ids.txt\n"
  mine:
    cmd: "src/motif_mining/mining/gaston_cov.py data/mining/240522-split/train --size
      3 --support 30\n"
  extract:
    cmd: "src/motif_mining/mining/extract_results.py data/mining/240522-split/train
      --purge_motifs --processes 8\n"
    outs:
    - path: data/mining/240522-split/train/motifs
      hash: md5
      md5: 2100ab4d48aee30ece9a3aedda3da3f5.dir
      size: 112639018
      nfiles: 2
  match:
    cmd: "src/motif_mining/mining/match_motifs.py data/mining/240522-split/train/motifs
      data/mining/expression/expression_binned.csv data/mining/240522-split/train/meta.csv
      data/mining/240522-split/meta.csv data/mining/240522-split/freq/matched_motifs.csv\n"
    outs:
    - path: data/mining/240522-split/freq/matched_motifs.csv
      hash: md5
      md5: fec477950914ab03bde28420b087ee04
      size: 2688016075
  join_metadata:
    cmd: "src/motif_mining/mining/join_metadata.py data/zhong2021/meta.csv data/mining/240522-split/train/gaston_files
      data/mining/240522-split/train/meta.csv\n"
    outs:
    - path: data/mining/240522-split/train/meta.csv
      hash: md5
      md5: 704bb1036e143baf99bbecb423842c37
      size: 13721
  setup:
    cmd: src/setup.sh
  analysis:
    cmd: echo 'placeholder'
    deps:
    - path: data/mining/240522-split/freq/matched_motifs.csv
      hash: md5
      md5: f3491f4b45a0056772c3bde22585b3ec
      size: 2549634893
    - path: data/zhong2021/expression.csv
      hash: md5
      md5: 31f7c3a1ef3652f6339239ea930bc15c
      size: 5097801
    - path: data/zhong2021/meta.csv
      hash: md5
      md5: 619531e2e55af98259c906226e2b9e62
      size: 1688
    - path: data/zhong2021/s4-plasma_protein_profiling.csv
      hash: md5
      md5: 424729302ee88b4643739db1a3554ba3
      size: 1807575
    - path: data/zhong2021/s6-diff_proteins.csv
      hash: md5
      md5: da10e84a9f77084fdd096988354a6fe2
      size: 7982
  freq:
    cmd: "src/motif_mining/freq/freq.py data/mining/240522-split/freq/matched_motifs.csv\n"
    deps:
    - path: data/mining/240522-split/freq/matched_motifs.csv
      hash: md5
      md5: fec477950914ab03bde28420b087ee04
      size: 2688016075
    outs:
    - path: data/mining/240522-split/freq/diffs_all.csv
      hash: md5
      md5: 867ac864b8c8181cf81950bc4d62c35e
      size: 11438980
    - path: data/mining/240522-split/freq/diffs_train.csv
      hash: md5
      md5: 35e4d09a298aa99306b22ac03fbfa122
      size: 11357814
    - path: data/mining/240522-split/freq/diffs_valid.csv
      hash: md5
      md5: 776505c6d46b09a4ca36a41b3fd9af76
      size: 9531304
    - path: data/mining/240522-split/freq/motif_profile.csv
      hash: md5
      md5: 9e965b6afd549eade404614954abb92c
      size: 92357836
  filter:
    cmd: "src/motif_mining/mining/filter.py data/mining/240522-split/freq/matched_motifs.csv
      data/string/9606.protein.physical.links.detailed.v12.0.txt.gz data/mining/240522-split/freq/matched_motifs.csv
      --no_cache\n"
